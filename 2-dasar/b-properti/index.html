<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6 Properti</title>

    <script src="//unpkg.com/alpinejs" defer></script>

    <style>
        [x-cloak] {
            display: none;
        }

        body {
            margin-bottom: 10em;
        }
    </style>
</head>

<body>
    <h1>Properti-properti di Alpine</h1>

    <h2>1. $el</h2>

    <P>
        Properti <code>$el</code> adalah elemen HTML yang diikat oleh Alpine.
    </P>

    <h3>Contoh</h3>

    <div x-data x-init="$el.style.backgroundColor = 'red'">
        <p x-init="$el.innerText = 'ini init'" @click="$el.innerText='ini onclick'"></p>

        <p x-init="$el.innerText = 'ini init elemen 2'"></p>
    </div>

    <h3>Contoh lain</h3>

    <div x-data x-init="$el.style.backgroundColor = 'green'">
        <p x-init="$el.style.backgroundColor = 'red'" @click="$el.innerText='ini onclick'">
            ini P pertama
        </p>
        <p x-init="$el.style.backgroundColor = 'blue'">ini P kedua</p>
    </div>

    <h2>2. $refs</h2>

    <p>
        Properti <code>$refs</code> adalah objek yang berisi referensi ke elemen HTML yang diikat oleh Alpine.
    </p>

    <h3>contoh</h3>

    <div x-data>
        <button @click="$refs.teks1.remove()">Remove Text</button>

        <span x-ref="teks1">Hello ini span pertama ðŸ‘‹</span>

        <span x-ref="teks2">Hello ini span kedua ðŸ‘‹</span>
    </div>

    <div x-data>
        <button @click="$refs.teks1.remove()">Remove Text</button>

        <!-- nama x-ref bisa sama selama beda x-data -->
        <span x-ref="teks1">Hello ðŸ‘‹</span>
    </div>

    <a href="../a-atribut/index.html#x-ref">lihat materi atribut x-ref</a>

    <h2>3. $store</h2>

    <p>
        Properti <code>$store</code> adalah objek yang berisi data yang diikat oleh Alpine.
    </p>

    <h3>Contoh 1</h3>

    <div x-data x-text="$store.user.name"></div>

    <div x-data x-text="$store.user.name"></div>

    <button x-data @click="$store.user.setName('Budi')">Ubah nama pengguna</button>

    <div x-data x-text="$store.contohSingleValue"></div>

    <h3>Contoh 2</h3>

    <div x-data x-text="$store.user.name"></div>

    <div x-data x-text="$store.user.name"></div>

    <div x-data>
        <input x-ref="inputNama" />
        <button @click="$store.user.setName($refs.inputNama.value)">submit</button>
    </div>

    <h3>Contoh 3</h3>

    <div x-data>
        Halo, Selamat datang, <span x-text="$store.user.name"></span>
    </div>

    <h2>4. $watch</h2>

    <p>
        Properti <code>$watch</code> adalah objek yang berisi fungsi yang akan dipanggil ketika properti yang diikat
        oleh Alpine berubah.
    </p>

    <h3>Contoh 1</h3>

    <div x-data="{ nama: 'John Doe', umur: 30 }">
        <input type="text" x-model="nama" />
        <input type="number" x-model="umur" />

        <div x-text="nama"></div>
        <div x-text="umur"></div>

        <div x-text="$watch('nama', value => console.log('nama berubah menjadi: ' + value))"></div>
        <div x-text="$watch('umur', () => console.log('umur berubah'))"></div>
    </div>

    <h3>Contoh 2: Pokemon Card</h3>

    <div x-data="{
        isOpenPreview: false,
        searchText: '',
        dataPokemon: {},
    }">
        <div x-show="isOpenPreview" x-init="$watch('isOpenPreview', () => {
            if(isOpenPreview) {
                fetch('https://pokeapi.co/api/v2/pokemon/' + searchText)
                    .then(response => response.json())
                    .then(data => dataPokemon = data)
            }
        })">
            <h1 x-text="dataPokemon.name"></h1>
            <p x-text="'Bobot: ' + dataPokemon.weight"></p>
        </div>

        <input type="text" placeholder="Tulis nama Pokemon" x-model="searchText">
        <button @click="isOpenPreview = !isOpenPreview">Lihat Pokemon</button>
    </div>

    <h2>5. $dispatch</h2>

    <p>
        Properti <code>$dispatch</code> adalah fungsi yang memungkinkan Anda mengirimkan event ke elemen lain.
    </p>

    <h3>Contoh 1</h3>

    <div x-data>
        <div @notify="alert('Hello World!')">
            <button @click="$dispatch('notify')">
                Notify
            </button>
        </div>
    </div>

    <h3>Contoh 2</h3>
    <div x-data="{
        nama: ''
    }">
        <h1 @tombol-diklik.window="nama = $event.detail" x-text="nama"></h1>
    </div>

    <div x-data>
        <input type="text" x-ref="inputNama">
        <button @click="$dispatch('tombol-diklik', $refs.inputNama.value)">Kirim</button>
    </div>


    <script>
        document.addEventListener('tombol-diklik', event => {
            // fetch('')
        })

        document.addEventListener('alpine:init', () => {
            // Alpine.store('NAMA PROPERTI', 'NILAI');

            Alpine.store('user', {
                name: 'John Doe',
                age: 30,

                setName(namaBaru) {
                    this.name = namaBaru;
                }
            })

            Alpine.store('contohSingleValue', 'ini contoh single value');

        })
    </script>

</body>

</html>